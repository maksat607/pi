SELECT SUM(fare*(CASE type when 'credit' then 0.95 when 'voucher' then 0.93 ELSE 1 end)  ) as total FROM income where  (date BETWEEN '2015-09-26 00:00:00' AND '2015-10-15 23:59:59SELECT SUM(fare*(CASE type when @type then (CASE @type when 'credit' then 0.95 when 'voucher' then 0.93 ELSE 1 end)  ELSE 0 end) )  as total FROM income where  (date BETWEEN '2015-09-26  00:00:00' AND '2015-10-15  23:59:59');    SELECT SUM(fare*(CASE type when '{$this->type}' then (CASE '{$this->type}' when 'credit' then 0.95 when 'voucher' then 0.93 ELSE 1 end)  ELSE 0 end) )   as total FROM income where  (date BETWEEN '{$this->startd}  00:00:00' AND '{$this->endd}  23:59:59');      SELECT now() as date,SUM(fare*(CASE type when '{$this->type}' then (CASE '{$this->type}' when 'credit' then 0.95 when 'voucher' then 0.93 ELSE 1 end)  ELSE 0 end) )   as total FROM income where  (date BETWEEN '{$this->startd}   00:00:00' AND '{$this->endd}  23:59:59') union all select date, fare from income where type='{$this->type}';   